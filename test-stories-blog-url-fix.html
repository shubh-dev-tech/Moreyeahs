<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Stories Blog URL Fix</title>
</head>
<body>
    <h1>Test Stories Blog URL Fix</h1>
    
    <h2>URL Conversion Test</h2>
    <div id="test-results"></div>
    
    <script>
        // Test the URL conversion logic
        function testUrlConversion() {
            const testCases = [
                {
                    input: 'http://localhost/moreyeahs-new/case-study/hello-world/',
                    expected: 'http://localhost:3001/case-study/hello-world'
                },
                {
                    input: 'http://localhost/moreyeahs-new/case-study/another-case/',
                    expected: 'http://localhost:3001/case-study/another-case'
                },
                {
                    input: 'http://localhost/moreyeahs-new/case-study/test-case-study/',
                    expected: 'http://localhost:3001/case-study/test-case-study'
                }
            ];
            
            function getPostUrl(postLink, postType = 'case_study') {
                // Convert WordPress URLs to Next.js frontend URLs
                if (postType === 'case_study' && postLink) {
                    // Extract slug from WordPress URL
                    const urlParts = postLink.split('/');
                    const slug = urlParts[urlParts.length - 2] || urlParts[urlParts.length - 1];
                    
                    if (slug) {
                        // Use current origin for the Next.js URL (automatically detects the correct port)
                        if (typeof window !== 'undefined') {
                            return `${window.location.origin}/case-study/${slug}`;
                        }
                        // Fallback for server-side rendering
                        return `/case-study/${slug}`;
                    }
                }
                
                // For other post types, fallback to original link
                return postLink;
            }
            
            const results = document.getElementById('test-results');
            let html = '<table border="1" style="border-collapse: collapse; width: 100%;">';
            html += '<tr><th>Input URL</th><th>Expected</th><th>Actual</th><th>Status</th></tr>';
            
            testCases.forEach(testCase => {
                const actual = getPostUrl(testCase.input);
                const status = actual === testCase.expected ? '✅ PASS' : '❌ FAIL';
                
                html += `<tr>
                    <td>${testCase.input}</td>
                    <td>${testCase.expected}</td>
                    <td>${actual}</td>
                    <td>${status}</td>
                </tr>`;
            });
            
            html += '</table>';
            results.innerHTML = html;
        }
        
        // Run test when page loads
        window.onload = testUrlConversion;
    </script>
    
    <h2>Instructions</h2>
    <p>This test verifies that the URL conversion logic works correctly:</p>
    <ol>
        <li>WordPress URLs like <code>http://localhost/moreyeahs-new/case-study/hello-world/</code></li>
        <li>Should be converted to Next.js URLs like <code>http://localhost:3001/case-study/hello-world</code></li>
        <li>The conversion should extract the slug and use the current origin</li>
    </ol>
    
    <h2>Next Steps</h2>
    <p>After this fix:</p>
    <ol>
        <li>Go to your WordPress admin and add a Stories & Blog Block</li>
        <li>Configure it to show Case Studies</li>
        <li>Click on any case study link</li>
        <li>It should now redirect to <code>http://localhost:3001/case-study/[slug]</code> instead of the WordPress URL</li>
    </ol>
</body>
</html>